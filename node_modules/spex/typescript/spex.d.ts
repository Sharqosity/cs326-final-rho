////////////////////////////////////////
<<<<<<< HEAD
// Requires SPEX v1.2.0 or later.
=======
// Requires SPEX v3.0.0 or later.
>>>>>>> 104b65a6409f9d6ba105288e6952992f9f09ce79
////////////////////////////////////////

declare namespace spex {

<<<<<<< HEAD
    type TOriginData = {
        success: boolean,
        result: any
    };

    type TBatchData = {
        success: boolean,
        result: any,
        origin?: TOriginData
    };
=======
    interface IOriginData {
        success: boolean;
        result: any;
    }

    interface IBatchData {
        success: boolean;
        result: any;
        origin?: IOriginData;
    }
>>>>>>> 104b65a6409f9d6ba105288e6952992f9f09ce79

    interface IBatchStat {
        total: number;
        succeeded: number;
        failed: number;
        duration: number;
    }

<<<<<<< HEAD
    type TStreamReadOptions = {
        closable?: boolean,
        readSize?: number
    };

    type TStreamReadResult = {
=======
    interface IStreamReadOptions {
        closable?: boolean;
        readChunks?: boolean;
        readSize?: number;
    }

    interface IStreamReadResult {
>>>>>>> 104b65a6409f9d6ba105288e6952992f9f09ce79
        calls: number;
        reads: number;
        length: number;
        duration: number;
<<<<<<< HEAD
    };

    type TPageResult = {
        pages: number,
        total: number,
        duration: number
    };

    type TSequenceResult = {
        total: number,
        duration: number
    };
=======
    }

    interface IPageResult {
        pages: number;
        total: number;
        duration: number;
    }

    interface ISequenceResult {
        total: number;
        duration: number;
    }
>>>>>>> 104b65a6409f9d6ba105288e6952992f9f09ce79

    interface IArrayExt<T> extends Array<T> {
        duration: number;
    }

<<<<<<< HEAD
    // API: http://vitaly-t.github.io/spex/errors.BatchError.html
    interface IBatchError extends Error {

        // standard error properties:
        name: string;
        message: string;
        stack: string;

        // extended properties:
        data: Array<TBatchData>;

        stat: IBatchStat;

        first: any;

        // API: http://vitaly-t.github.io/spex/errors.BatchError.html#.getErrors
        getErrors(): Array<any>;

        // API: http://vitaly-t.github.io/spex/errors.BatchError.html#.toString
        toString(): string;
    }

    // API: http://vitaly-t.github.io/spex/errors.PageError.html
    interface IPageError extends Error {

        // standard error properties:
        name: string;
        message: string;
        stack: string;

        // extended properties:
        error: any;
        index: number;
        duration: number;
        reason: string;
        source: any;
        dest: any;

        // API: http://vitaly-t.github.io/spex/errors.PageError.html#.toString
        toString(): string;
    }

    // API: http://vitaly-t.github.io/spex/errors.SequenceError.html
    interface ISequenceError extends Error {

        // standard error properties:
        name: string;
        message: string;
        stack: string;

        // extended properties:
        error: any;
        index: number;
        duration: number;
        reason: string;
        source: any;
        dest: any;

        // API: http://vitaly-t.github.io/spex/errors.SequenceError.html#.toString
        toString(): string;

    }

    interface IErrors {
        BatchError: IBatchError;
        PageError: IPageError;
        SequenceError: ISequenceError;
=======
    // Errors namespace
    // API: http://vitaly-t.github.io/spex/errors.html
    namespace errors {
        // API: http://vitaly-t.github.io/spex/errors.BatchError.html
        class BatchError extends Error {

            // standard error properties:
            name: string;
            message: string;
            stack: string;

            // extended properties:
            data: Array<IBatchData>;

            stat: IBatchStat;

            first: any;

            // API: http://vitaly-t.github.io/spex/errors.BatchError.html#.getErrors
            getErrors(): Array<any>;

            // API: http://vitaly-t.github.io/spex/errors.BatchError.html#.toString
            toString(): string;
        }

        // API: http://vitaly-t.github.io/spex/errors.PageError.html
        class PageError extends Error {

            // standard error properties:
            name: string;
            message: string;
            stack: string;

            // extended properties:
            error: any;
            index: number;
            duration: number;
            reason: string;
            source: any;
            dest: any;

            // API: http://vitaly-t.github.io/spex/errors.PageError.html#.toString
            toString(): string;
        }

        // API: http://vitaly-t.github.io/spex/errors.SequenceError.html
        class SequenceError extends Error {

            // standard error properties:
            name: string;
            message: string;
            stack: string;

            // extended properties:
            error: any;
            index: number;
            duration: number;
            reason: string;
            source: any;
            dest: any;

            // API: http://vitaly-t.github.io/spex/errors.SequenceError.html#.toString
            toString(): string;

        }
>>>>>>> 104b65a6409f9d6ba105288e6952992f9f09ce79
    }

    // API: http://vitaly-t.github.io/spex/stream.html
    interface IStream {
        // API: http://vitaly-t.github.io/spex/stream.html#.read
<<<<<<< HEAD
        read(stream: any, receiver: (index: number, data: Array<any>, delay: number) => any, closable?: boolean, readSize?: number): Promise<spex.TStreamReadResult>;
        read(stream: any, receiver: (index: number, data: Array<any>, delay: number) => any, options?: spex.TStreamReadOptions): Promise<spex.TStreamReadResult>;
=======
        read(stream: any, receiver: (index: number, data: Array<any>, delay: number) => any, options?: IStreamReadOptions): Promise<IStreamReadResult>;
>>>>>>> 104b65a6409f9d6ba105288e6952992f9f09ce79
    }

    // PromiseAdapter class;
    // API: http://vitaly-t.github.io/spex/PromiseAdapter.html
    class PromiseAdapter {
<<<<<<< HEAD
        constructor(create: (cb: any) => Object, resolve: (data: any) => void, reject: (reason: any) => void);
=======
        constructor(create: (cb: any) => object, resolve: (data: any) => void, reject: (reason: any) => void);
>>>>>>> 104b65a6409f9d6ba105288e6952992f9f09ce79
    }

    // Subset of the base methods only, to be used by pg-promise
    interface ISpexBase {

        // API: http://vitaly-t.github.io/spex/global.html#batch
<<<<<<< HEAD
        batch(values: Array<any>, cb?: (index: number, success: boolean, result: any, delay: number) => any): Promise<IArrayExt<any>>;
        batch(values: Array<any>, options: {cb?: (index: number, success: boolean, result: any, delay: number) => any}): Promise<IArrayExt<any>>;

        // API: http://vitaly-t.github.io/spex/global.html#page
        page(source: (index: number, data: any, delay: number) => any, dest?: (index: number, data: any, delay: number) => any, limit?: number): Promise<TPageResult>;
        page(source: (index: number, data: any, delay: number) => any, options: {dest?: (index: number, data: any, delay: number) => any, limit?: number}): Promise<TPageResult>;

        // API: http://vitaly-t.github.io/spex/global.html#sequence
        sequence(source: (index: number, data: any, delay: number) => any, dest?: (index: number, data: any, delay: number) => any, limit?: number, track?: boolean): Promise<TSequenceResult | IArrayExt<any>>;
        sequence(source: (index: number, data: any, delay: number) => any, options: {dest?: (index: number, data: any, delay: number) => any, limit?: number, track?: boolean}): Promise<TSequenceResult | IArrayExt<any>>;
=======
        batch(values: Array<any>, options?: { cb?: (index: number, success: boolean, result: any, delay: number) => any }): Promise<IArrayExt<any>>;

        // API: http://vitaly-t.github.io/spex/global.html#page
        page(source: (index: number, data: any, delay: number) => any, options?: { dest?: (index: number, data: any, delay: number) => any, limit?: number }): Promise<IPageResult>;

        // API: http://vitaly-t.github.io/spex/global.html#sequence
        sequence(source: (index: number, data: any, delay: number) => any, options?: { dest?: (index: number, data: any, delay: number) => any, limit?: number, track?: boolean }): Promise<ISequenceResult | IArrayExt<any>>;
>>>>>>> 104b65a6409f9d6ba105288e6952992f9f09ce79
    }

    interface ISpex extends ISpexBase {

        // API: http://vitaly-t.github.io/spex/stream.html
        stream: IStream;

        // API: http://vitaly-t.github.io/spex/errors.html
<<<<<<< HEAD
        errors: IErrors;
=======
        errors: typeof errors;
>>>>>>> 104b65a6409f9d6ba105288e6952992f9f09ce79
    }

}

declare function spex(promise: any): spex.ISpex;

export = spex;
